using ICD.Connect.Protocol.Network.Utils;
using NUnit.Framework;

namespace ICD.Connect.Protocol.Network.Tests.Utils
{
	[TestFixture]
	public sealed class JwtUtilsTest
	{
		[TestCase("eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiAiY2FsZW5kYXItc2VydmljZUBjYWxlbmRhcmluZy5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSIsICJpYXQiOiAxNTYzODExMzc4LCAiZXhwIjogMTU2MzgxMzE3OCwgImF1ZCI6ICJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9vYXV0aDIvdjQvdG9rZW4iLCAic2NvcGUiOiAiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9jYWxlbmRhciJ9.m7WKvkGY99MR5cbfANTywhO29qVsv70RxrAJcUXhgYXS4s7wRcUU5pLcsmSRUfroMlzQVIbZy_cnMeKe1IOfHreRCPwoRituut_6xcdpZQu2GD6v_Zhg_SkRGzpUBJi2LrLAtHQhkbKZrCDJCNxf0-TbtROJU1iO-LMWclUbJp4Sru7S0JkiiNfnY8P3wW46aHY8g4V5w6gIP-DeQAqInZwS6F7v65ac-ICLQ9kwCF3lZwdKPbdIMrgctDUFeMSqfeLf8isJQ_N52e73NWRSPAQ7x9_krUT2VG8wsLyvZm49Xce1Qj2n9l36iTOqhapBG-0Uc396hjnqJlcKEgDwZA",
			@"{""iss"": ""calendar-service@calendaring.iam.gserviceaccount.com"", ""iat"": 1563811378, ""exp"": 1563813178, ""aud"": ""https://www.googleapis.com/oauth2/v4/token"", ""scope"": ""https://www.googleapis.com/auth/calendar""}",
			"MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC/XmHSIIDyBuQv48wweLDHXIysAIiwoLrd+UC0mt+M8J6WKL1kjw3EH0S/u+rTcTmkYoD8g5dph3v9HaU0kEgsRVG0hIuqltuyAYqefpyNtAm9gacLq4t9CoKJ/k/C7R3wu6UgvRtCyilB3gUqqFOp+oaI7+0nPv/K3FBW4l8U/Mub/iIiIE3Kt6fik2VeSKZzx2LnX8b2jfTHmICqxj8zAT8trmoNMc8OFwFHaX2oaLpl9a2cbUDW5iKCX5qDdWI5O7Dyphy2qleeQ+YRZ9TinbNbIu8VLahSx2bjNCez6WjJGBoTgyL+6uRLeNKXnLH85G5OTIY7XQFqyD6dvBQ3AgMBAAECggEADEIZdgJLADXczAyFed1hRYPyJtpp5xaEoc9ji64X/8kx/2BgsV5QfW2bU8TPx/eKv7LnnEU5n7LkCFSrznAnj15pW2zaHXVIYWCj5n8pvBH6Rb9WWfMFHl9b+UbnCQ9zSYZbj3tNkbutZOC55/+cTFkV4ROtV0Q70lzGcKpTeN6UN5PwaNyP2ScBf3xvYoBU8dDOvBHJQQdgpNYyjxyKdqt1mrL9kze+nWCddrMwSTvx6PKQiAVrgIH0CDdexAA2koZZP2FP7z+cWDn92sETYDGRKFlzlPuq3Y4cUFt83jhQQcQZ+LTLm1UeTAd97veSEVmrH0RUGDRJ78cD7mHcUQKBgQDh7v+SL0ZjexsZLaorSeaPjGPV9Z6r2D2o+AYofaCY6H0fKCP9Yi1to8VweA6IKcR6CaEC2k3faFXdOX9pCRfV+vBVWJR95SMPlFxh9ufWhz8mIz/PyyiTJuyrcOSnOonsNN9ggypE8IfqPQkyeaAKIvaqN09f6rg2BF/SGaxYIwKBgQDY1deoK6BtcD7Zrw+XkWmQID0ZRSUoHmWo2vwfgXpwjbjrFIGBJSS1/TV2gf24HyFv/mPxtHc5EQ0gr3ui0eADWyS1oH+sMz+XkYGsD9Udn7umGpQ3aUnBy89lzNGu9bP6UV01L1cE1SRPe3vS8pkxXoS6J12KDFI3k7hTy0zq3QKBgQDTIV+NAUaa0kDZf5XlDBM8E+p72CLl3ZaJXvWKQxOfsKq0QfOX5nYjXga0ekzCK53imTrwioZ4/mw25nNM+WVf3jdW2gcxur3P4kmOdofiLtLxVcFc8jHBiX9jGoViTM70f9g6vXfzon6wg0cj9wp6ToAJQtSXAqYQPHg6wykN1wKBgQCeKSS7ks7a5KPDbnDGEpfYO9u1If1fTQTD7K84X94qWQWH2xY3WBt173LetSSW94YRRZIrDIJmCqzzqWxaMBHhAMs+/AoEVgFNkiHumkHN8OQT3ZE89byJ8hqeW46aureDn3OIRraHXNy2aRDBppjdLN9NVUdiWWhjB4nM/R5mtQKBgHHUyX7xu8ayB3md8ervftbig2O7biSGA51tLGRSLTPyj4bhDhlYzhzLz3qQB7QpIH1yGhA/PoY0Dt6ybvVayYukGIOuviOaLfO+eQK+1YmMApD/zu+00R35+lmiBRhvBGdhMiQtEHvNZ3Qqdey9eRuUjnE41Bswi+NSnLMaqHP6")]
		public void SignRs256(string expected, string payload, string privateKey)
		{
			Assert.AreEqual(expected, JwtUtils.SignRs256(payload, privateKey));
		}
	}
}
