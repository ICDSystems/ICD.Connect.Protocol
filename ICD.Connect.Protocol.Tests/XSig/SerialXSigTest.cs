using System;
using System.Collections.Generic;
using System.Linq;
using ICD.Common.Utils;
using ICD.Common.Utils.Extensions;
using ICD.Connect.Protocol.XSig;
using NUnit.Framework;

namespace ICD.Connect.Protocol.Tests.XSig
{
    [TestFixture]
    public sealed class SerialXSigTest
    {
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)1002,
            "\xCF\x69\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase("", (ushort)1, "\xC8\x00\xFF")]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)1,
            "\xC8\x00\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            (ushort)1,
            "\xC8\x00\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase("", (ushort)342, "\xCA\x55\xFF")]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)342,
            "\xCA\x55\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            (ushort)342,
            "\xCA\x55\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase("", (ushort)683, "\xCD\x2A\xFF")]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)683,
            "\xCD\x2A\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            (ushort)683,
            "\xCD\x2A\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase("", (ushort)1002, "\xCF\x69\xFF")]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)1002,
            "\xCF\x69\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            (ushort)1002,
            "\xCF\x69\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase("", (ushort)1024, "\xCF\x7F\xFF")]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)1024,
            "\xCF\x7F\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            (ushort)1024,
            "\xCF\x7F\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        public void DataTest(string value, ushort index, string expected)
        {
            SerialXSig sig = new SerialXSig(value, index);
            Assert.AreEqual(StringUtils.ToBytes(expected), sig.Data);
        }

        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)1002,
            "\xCF\x69\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase("", (ushort)1, "\xC8\x00\xFF")]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)1,
            "\xC8\x00\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            (ushort)1,
            "\xC8\x00\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase("", (ushort)342, "\xCA\x55\xFF")]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)342,
            "\xCA\x55\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            (ushort)342,
            "\xCA\x55\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase("", (ushort)683, "\xCD\x2A\xFF")]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)683,
            "\xCD\x2A\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            (ushort)683,
            "\xCD\x2A\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase("", (ushort)1002, "\xCF\x69\xFF")]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)1002,
            "\xCF\x69\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            (ushort)1002,
            "\xCF\x69\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase("", (ushort)1024, "\xCF\x7F\xFF")]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)1024,
            "\xCF\x7F\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            (ushort)1024,
            "\xCF\x7F\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        public void DataStringTest(string value, ushort index, string expected)
        {
            SerialXSig sig = new SerialXSig(value, index);
            Assert.AreEqual(expected, sig.DataXSig);
        }

        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)1002)]
        [TestCase("", (ushort)1)]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)1)]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            (ushort)1)]
        [TestCase("", (ushort)342)]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)342)]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            (ushort)342)]
        [TestCase("", (ushort)683)]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)683)]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            (ushort)683)]
        [TestCase("", (ushort)1002)]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)1002)]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            (ushort)1002)]
        [TestCase("", (ushort)1024)]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)1024)]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            (ushort)1024)]
        public void ValueTest(string value, ushort index)
        {
            SerialXSig sig = new SerialXSig(value, index);
            Assert.AreEqual(value, sig.Value);
        }

        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)1002)]
        [TestCase("", (ushort)1)]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)1)]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            (ushort)1)]
        [TestCase("", (ushort)342)]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)342)]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            (ushort)342)]
        [TestCase("", (ushort)683)]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)683)]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            (ushort)683)]
        [TestCase("", (ushort)1002)]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)1002)]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            (ushort)1002)]
        [TestCase("", (ushort)1024)]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog", (ushort)1024)]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            (ushort)1024)]
        public void IndexTest(string value, ushort index)
        {
            SerialXSig sig = new SerialXSig(value, index);
            Assert.AreEqual(index, sig.Index);
        }

        [TestCase(
            "\xCF\x69\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase("\xC8\x00\xFF")]
        [TestCase(
            "\xC8\x00\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "\xC8\x00\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase("\xCA\x55\xFF")]
        [TestCase(
            "\xCA\x55\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "\xCA\x55\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase("\xCD\x2A\xFF")]
        [TestCase(
            "\xCD\x2A\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "\xCD\x2A\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase("\xCF\x69\xFF")]
        [TestCase(
            "\xCF\x69\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "\xCF\x69\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase("\xCF\x7F\xFF")]
        [TestCase(
            "\xCF\x7F\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "\xCF\x7F\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        public void DataFromDataTest(string data)
        {
            SerialXSig sig = new SerialXSig(StringUtils.ToBytes(data));
            Assert.AreEqual(data, StringUtils.ToString(sig.Data));
        }

        [TestCase(
            "\xCF\x69\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase("\xC8\x00\xFF")]
        [TestCase(
            "\xC8\x00\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "\xC8\x00\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase("\xCA\x55\xFF")]
        [TestCase(
            "\xCA\x55\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "\xCA\x55\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase("\xCD\x2A\xFF")]
        [TestCase(
            "\xCD\x2A\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "\xCD\x2A\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase("\xCF\x69\xFF")]
        [TestCase(
            "\xCF\x69\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "\xCF\x69\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase("\xCF\x7F\xFF")]
        [TestCase(
            "\xCF\x7F\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "\xCF\x7F\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        public void DataFromDataStringTest(string data)
        {
            SerialXSig sig = new SerialXSig(StringUtils.ToBytes(data));
            Assert.AreEqual(data, sig.DataXSig);
        }

        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog",
            "\xCF\x69\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase("", "\xC8\x00\xFF")]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog",
            "\xC8\x00\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            
            "\xC8\x00\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase("", "\xCA\x55\xFF")]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog",
            "\xCA\x55\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            
            "\xCA\x55\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase("", "\xCD\x2A\xFF")]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog",
            "\xCD\x2A\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            
            "\xCD\x2A\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase("", "\xCF\x69\xFF")]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog",
            "\xCF\x69\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            
            "\xCF\x69\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase("", "\xCF\x7F\xFF")]
        [TestCase("The Quick Brown Fox Jumped Over the Lazy Dog",
            "\xCF\x7F\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent mauris lectus, interdum sit amet nisi ac, tempor condimentum nisl. In hac habitasse platea dictumst. Praesent placerat lacinia augue at auctor. Fusce ornare quis quam at laoreet posuere.",
            
            "\xCF\x7F\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        public void ValueFromDataTest(string value, string data)
        {
            SerialXSig sig = new SerialXSig(StringUtils.ToBytes(data));
            Assert.AreEqual(value, sig.Value);
        }

        [TestCase((ushort)1002,
            "\xCF\x69\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase((ushort)1, "\xC8\x00\xFF")]
        [TestCase((ushort)1,
            "\xC8\x00\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            (ushort)1,
            "\xC8\x00\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase((ushort)342, "\xCA\x55\xFF")]
        [TestCase((ushort)342,
            "\xCA\x55\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            (ushort)342,
            "\xCA\x55\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase((ushort)683, "\xCD\x2A\xFF")]
        [TestCase((ushort)683,
            "\xCD\x2A\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            (ushort)683,
            "\xCD\x2A\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase((ushort)1002, "\xCF\x69\xFF")]
        [TestCase((ushort)1002,
            "\xCF\x69\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            (ushort)1002,
            "\xCF\x69\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        [TestCase((ushort)1024, "\xCF\x7F\xFF")]
        [TestCase((ushort)1024,
            "\xCF\x7F\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF")]
        [TestCase(
            (ushort)1024,
            "\xCF\x7F\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF")]
        public void IndexFromData(ushort index, string data)
        {
            SerialXSig sig = new SerialXSig(StringUtils.ToBytes(data));
            Assert.AreEqual(index, sig.Index);
        }

        [TestCase("\x00", false)]
        [TestCase("\x80\x0A", false)]
        [TestCase("\xA0\x0E", false)]
        [TestCase("\xA0\x00", false)]
        [TestCase("\x80\x00", false)]
        [TestCase("\xAA\x55", false)]
        [TestCase("\x8A\x55", false)]
        [TestCase("\xB5\x2A", false)]
        [TestCase("\x95\x2A", false)]
        [TestCase("\xBF\x7F", false)]
        [TestCase("\x9F\x7F", false)]
        [TestCase("\xC0\x09\x01\x69", false)]
        [TestCase("\xC0\x00\x00\x00", false)]
        [TestCase("\xC0\x00\x00\x01", false)]
        [TestCase("\xE0\x00\x00\x05", false)]
        [TestCase("\xF0\x00\x7F\x7F", false)]
        [TestCase("\xC7\x68\x00\x00", false)]
        [TestCase("\xC7\x68\x00\x01", false)]
        [TestCase("\xE7\x68\x00\x05", false)]
        [TestCase("\xF7\x68\x7F\x7F", false)]
        [TestCase("\xC7\x7F\x00\x00", false)]
        [TestCase("\xC7\x7F\x00\x01", false)]
        [TestCase("\xE7\x7F\x00\x05", false)]
        [TestCase("\xF7\x7F\x7F\x7F", false)]
        [TestCase(
            "\xCF\x69\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF",
            true)]
        [TestCase("\xC8\x00\xFF", true)]
        [TestCase(
            "\xC8\x00\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF",
            true)]
        [TestCase(
            "\xC8\x00\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF",
            true)]
        [TestCase("\xCA\x55\xFF", true)]
        [TestCase(
            "\xCA\x55\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF",
            true)]
        [TestCase(
            "\xCA\x55\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF",
            true)]
        [TestCase("\xCD\x2A\xFF", true)]
        [TestCase(
            "\xCD\x2A\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF",
            true)]
        [TestCase(
            "\xCD\x2A\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF",
            true)]
        [TestCase("\xCF\x69\xFF", true)]
        [TestCase(
            "\xCF\x69\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF",
            true)]
        [TestCase(
            "\xCF\x69\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF",
            true)]
        [TestCase("\xCF\x7F\xFF", true)]
        [TestCase(
            "\xCF\x7F\x54\x68\x65\x20\x51\x75\x69\x63\x6B\x20\x42\x72\x6F\x77\x6E\x20\x46\x6F\x78\x20\x4A\x75\x6D\x70\x65\x64\x20\x4F\x76\x65\x72\x20\x74\x68\x65\x20\x4C\x61\x7A\x79\x20\x44\x6F\x67\xFF",
            true)]
        [TestCase(
            "\xCF\x7F\x4C\x6F\x72\x65\x6D\x20\x69\x70\x73\x75\x6D\x20\x64\x6F\x6C\x6F\x72\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x2C\x20\x63\x6F\x6E\x73\x65\x63\x74\x65\x74\x75\x72\x20\x61\x64\x69\x70\x69\x73\x63\x69\x6E\x67\x20\x65\x6C\x69\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x6D\x61\x75\x72\x69\x73\x20\x6C\x65\x63\x74\x75\x73\x2C\x20\x69\x6E\x74\x65\x72\x64\x75\x6D\x20\x73\x69\x74\x20\x61\x6D\x65\x74\x20\x6E\x69\x73\x69\x20\x61\x63\x2C\x20\x74\x65\x6D\x70\x6F\x72\x20\x63\x6F\x6E\x64\x69\x6D\x65\x6E\x74\x75\x6D\x20\x6E\x69\x73\x6C\x2E\x20\x49\x6E\x20\x68\x61\x63\x20\x68\x61\x62\x69\x74\x61\x73\x73\x65\x20\x70\x6C\x61\x74\x65\x61\x20\x64\x69\x63\x74\x75\x6D\x73\x74\x2E\x20\x50\x72\x61\x65\x73\x65\x6E\x74\x20\x70\x6C\x61\x63\x65\x72\x61\x74\x20\x6C\x61\x63\x69\x6E\x69\x61\x20\x61\x75\x67\x75\x65\x20\x61\x74\x20\x61\x75\x63\x74\x6F\x72\x2E\x20\x46\x75\x73\x63\x65\x20\x6F\x72\x6E\x61\x72\x65\x20\x71\x75\x69\x73\x20\x71\x75\x61\x6D\x20\x61\x74\x20\x6C\x61\x6F\x72\x65\x65\x74\x20\x70\x6F\x73\x75\x65\x72\x65\x2E\xFF",
            true)]
        public void IsSerial(string data, bool expected)
        {
            byte[] bytes = StringUtils.ToBytes(data);
            Assert.AreEqual(expected, SerialXSig.IsSerial(bytes));
        }
    }
}
